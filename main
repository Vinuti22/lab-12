<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JWT –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–°–∏–º—É–ª—è—Ç–æ—Ä)</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background-color: #f4f4f9; }
        .container { max-width: 400px; margin: 0 auto; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: #333; }
        input, button { width: 100%; padding: 10px; margin-bottom: 10px; border-radius: 4px; border: 1px solid #ccc; box-sizing: border-box; }
        button { background-color: #007bff; color: white; border: none; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        .success { color: green; font-weight: bold; }
        #app-content, #login-form { display: none; }
    </style>
</head>
<body>

    <div class="container">
        <div id="login-form">
            <h2>–í—Ö–æ–¥</h2>
            <form id="login-submit-form">
                <input type="email" id="email" placeholder="Email" required value="user@example.com">
                <input type="password" id="password" placeholder="–ü–∞—Ä–æ–ª—å" required value="password123">
                <button type="submit">–í–æ–π—Ç–∏</button>
            </form>
            <p style="text-align: center; font-size: small;">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª—é–±—ã–µ –¥–∞–Ω–Ω—ã–µ, –æ–Ω–∏ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è.</p>
        </div>

        <div id="app-content">
            <h2>üîê –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</h2>
            <p class="success">–í—ã —É—Å–ø–µ—à–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã!</p>
            <p>–í–∞—à "JWT –¢–æ–∫–µ–Ω" (—Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ **localStorage**):</p>
            <textarea id="token-display" rows="5" readonly style="width: 100%; margin-bottom: 15px; border: 1px dashed #007bff;"></textarea>
            <button id="logout-button">–í—ã—Ö–æ–¥</button>
        </div>
    </div>

    <script>
        // --- –õ–æ–≥–∏–∫–∞ JavaScript ---

        const TOKEN_KEY = 'authToken';

        const loginFormEl = document.getElementById('login-form');
        const appContentEl = document.getElementById('app-content');
        const loginSubmitFormEl = document.getElementById('login-submit-form');
        const logoutButtonEl = document.getElementById('logout-button');
        const tokenDisplayEl = document.getElementById('token-display');

        /**
         * 1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç "—Ñ–µ–π–∫–æ–≤—ã–π" JWT —Ç–æ–∫–µ–Ω.
         * –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —ç—Ç–æ—Ç —Ç–æ–∫–µ–Ω –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –±—ç–∫–µ–Ω–¥ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.
         * –ò—Å–ø–æ–ª—å–∑—É–µ–º Base64 –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∞ JWT.
         */
        function generateFakeJwt(email) {
            const header = btoa(JSON.stringify({ alg: 'HS256', typ: 'JWT' }));
            const payload = btoa(JSON.stringify({ 
                userId: 1, 
                email: email, 
                iat: Math.floor(Date.now() / 1000), 
                exp: Math.floor(Date.now() / 1000) + (60 * 60) // –ò—Å—Ç–µ–∫–∞–µ—Ç —á–µ—Ä–µ–∑ 1 —á–∞—Å
            }));
            const signature = btoa('fake_signature');
            return `${header}.${payload}.${signature}`;
        }

        /**
         * 2. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–∫–µ–Ω –≤ localStorage.
         */
        function login(token) {
            localStorage.setItem(TOKEN_KEY, token);
            renderApp();
        }

        /**
         * 4. –£–¥–∞–ª—è–µ—Ç —Ç–æ–∫–µ–Ω –∏–∑ localStorage.
         */
        function logout() {
            localStorage.removeItem(TOKEN_KEY);
            renderApp();
        }

        /**
         * 3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞ –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º.
         * –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –ø–æ—Å–ª–µ —Å–æ–±—ã—Ç–∏–π –≤—Ö–æ–¥–∞/–≤—ã—Ö–æ–¥–∞.
         */
        function renderApp() {
            const token = localStorage.getItem(TOKEN_KEY);

            if (token) {
                // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
                loginFormEl.style.display = 'none';
                appContentEl.style.display = 'block';
                tokenDisplayEl.value = token; // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ç–æ–∫–µ–Ω

            } else {
                // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
                appContentEl.style.display = 'none';
                loginFormEl.style.display = 'block';
            }
        }

        // --- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π ---

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã –≤—Ö–æ–¥–∞
        loginSubmitFormEl.addEventListener('submit', function(event) {
            event.preventDefault();
            const email = document.getElementById('email').value;
            // –ò–º–∏—Ç–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞
            const fakeToken = generateFakeJwt(email);
            login(fakeToken);
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ –≤—ã—Ö–æ–¥–∞
        logoutButtonEl.addEventListener('click', function() {
            logout();
        });

        // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ---

        // 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –ø–µ—Ä–≤–∏—á–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        document.addEventListener('DOMContentLoaded', renderApp);

    </script>
</body>
</html>
